{% extends "base.html" %}

{% block title %}Categories{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="text-center mb-4">
        <h1 class="font-weight-bold text-custom-color ">Categories</h1>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="alert alert-dark container w-75 text-center text-white bg-blue">
        {% for category, message in messages %}
        <div class="{{ category }}">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5 mb-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h4 class="card-title mb-4 d-flex justify-content-center text-custom-color">Add/Update Category</h4>
                    <form method="POST" action="{{ url_for('categories') }}">
                        <div class="form-group mb-3">
                            <label for="name" class="font-weight-bold">Name:</label>
                            <input type="text" id="name" name="name" placeholder="Name" required class="form-control borderRadius">
                        </div>

                        <div class="form-group mb-3">
                            <label for="description" class="font-weight-bold">Description:</label>
                            <textarea id="description" name="description" placeholder="Description" required class="form-control borderRadius" rows="3"></textarea>
                        </div>

                        <div class="text-center">
                            <button type="submit"  class="btn-outline-dark-blue btn-outline-dark-blue:hover ">Add/Update Category</button>
                        </div>

                    </form>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-5">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h4 class="card-title mb-4 d-flex justify-content-center text-custom-color ">Category List</h4>
                    <ul class="list-group">
                        {% for category in categories %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>{{ category.name }}</strong><br>
                                <small>{{ category.description }}</small>
                            </div>
                            <div>
                                <button class="btn btn-outline-dark-blue rounded-pill btn-sm mr-2" onclick="editCategory('{{ category.id }}', '{{ category.name }}', '{{ category.description }}')">Edit</button>
                                <form method="POST" action="{{ url_for('delete_category', category_id=category.id) }}" class="d-inline">
                                    <button type="submit" class="btn btn-outline-danger btn-sm" onclick=" return confirm('Are you sure you want to delete this category?')">Delete</button>
                                </form>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function editCategory(id, name, description) {
        document.getElementById('category_id').value = id;
        document.getElementById('name').value = name;
        document.getElementById('description').value = description;
    }
</script>
{% endblock %}
